<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>添加客户单位库</title>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="添加运输单位库">
    <link href="../image/ioc/favicon.ico" rel="icon" type="image/x-ico">

    <link rel="stylesheet" type="text/css" href="../js/layuiadmin/layui/css/layui.css">
    <link rel="stylesheet" type="text/css" href="./css/style.css">
    <link rel="stylesheet" href="./util/lgallery/css/lgallery.min.css">
    <link rel="stylesheet" href="./util/lgallery/css/demo.min.css">
    <link rel="stylesheet" href="../js/layuiadmin/style/login.css" media="all">
</head>
<body>
<div style="padding: 15px;">
    <form class="layui-form layui-form-pane">
        <div class="layui-form-item ">
            <div class="layui-inline">
                <label class="layui-form-label">设置用户名</label>
                <div class="layui-input-inline">
                    <input id="login_name" type="text" name="login_name" required lay-verify="required"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-inline ">
                <label class="layui-form-label">设置密码</label>
                <div class="layui-input-inline">
                    <input type="text" name="login_pwd" id="login_pwd" required lay-verify="required" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">客户简称</label>
                <div class="layui-input-inline">
                    <input type="text" name="short_name" id="short_name" required lay-verify="required"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">客户全称</label>
                <div class="layui-input-inline">
                    <input type="text" name="full_name" id="full_name" required lay-verify="required" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">客户类型</label>
                <div class="layui-input-inline">
                    <select name="type" id="type" required lay-verify="required">
                        <option value="">请选择一个类型</option>
                        <option value="1">大板车</option>
                        <option value="2">4s店</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">客户地址</label>
            <div class="layui-input-block">
                <input type="text" name="address" id="address" required lay-verify="required" autocomplete="off"
                       class="layui-input">
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">联系人</label>
                <div class="layui-input-inline">
                    <input type="text" name="contacts" id="contacts" required lay-verify="required" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">电话</label>
                <div class="layui-input-inline">
                    <input type="text" name="phone" id="phone" required lay-verify="required|phone" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">合同详情</label>
            <div class="layui-input-block">
                <button id="pz" photo-type="10" type="button" class="takePhoto layui-btn layui-btn-normal">拍照</button>
            </div>
        </div>
        <div id="photo10" class="layui-form-item hide">
            <fieldset class="layui-elem-field">
                <legend>合同照片</legend>
                <div class="layui-field-box">
                    <div class="TemplateParent" data-lgparent data-lgtitle="1,2,3,4,5"
                         data-lglabel="Picture 1,Picture 2,Picture 3,Picture 4,Picture 5"
                         data-lgdescription="Description 1, Description 2,Description 3,Description 4,Description 5">

                    </div>
                </div>
            </fieldset>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">账号</label>
                <div class="layui-input-inline">
                    <input type="text" name="bank_number" id="bank_number" required lay-verify="required"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">开户银行</label>
                <div class="layui-input-inline">
                    <input type="text" id="bank_name" name="bank_name" required lay-verify="required" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">免费天数</label>
            <div class="layui-input-block">
                <input type="text" id="free_days" name="free_days" required lay-verify="required" autocomplete="off"
                       class="layui-input">
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">洗车费</label>
                <div class="layui-input-inline">
                    <input type="text" id="car_wash_fee" name="car_wash_fee" required lay-verify="required"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">检验费</label>
                <div class="layui-input-inline">
                    <input type="text" id="car_check_fee" name="car_check_fee" required lay-verify="required"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">停车费/天/台</label>
                <div class="layui-input-inline">
                    <input type="text" id="car_park_fee" name="car_park_fee" required lay-verify="required"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-input-block">
                <button type="button" class="layui-btn" lay-submit lay-filter="demo1">立即添加</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>
    </form>
</div>
<div class="layui-trans layadmin-user-login-footer">
    <p style="color: white;">Copyright © 2019 by 中国联合网络通信有限公司宁波市分公司 All rights reserved.</p>
</div>
</body>
<script type="text/javascript" src="../js/jquery-1.8.3.min.js"></script>
<script src="../js/layuiadmin/layui/layui.js"></script>
<script type="text/javascript" src="../layer_mobile/layer.js"></script>
<script type="text/javascript" src="../js/jquery.md5.js"></script>
<script type="text/javascript" src="../js/jquery-geturlcode.js"></script>
<script type="text/javascript" src="../js/jquery.cookie.js"></script>
<script src="../js/common/api.js"></script>
<script src="../js/common/localjs.js"></script>
<script src="./util/lgallery/js/lgallery.min.js"></script>
<script type="text/javascript" src="../js/mui.min.js"></script>


<script>
    var contracts = [];//合同图片数组


    //Demo
    layui.use(['jquery', 'form', 'layer', 'jquery'], function () {
        var form = layui.form,
            $ = layui.$,
            layer = layui.layer;


        //调用高拍仪
        $(".takePhoto").on("click", function () {
            var that = $(this);
            console.log(that.attr("photo-type"));
            var as = layer.open({
                id: "takePhoto",
                type: 2,
                title: '高拍仪',
                maxmin: true,
                //area: ['1500px', '800px'],
                //content : path+'/voteback/add.html',
                content: 'photoTest/indexTwo.html?type=' + that.attr("photo-type"), //iframe的url
                success: function (layero, index) {
                    //传入参数，并赋值给iframe的元素
                },
                end: function (res) {
                    console.log("存储的图片数组---", contracts);
                    initLG();
                }
            });
            layer.full(as);
        });
        //监听提交
        form.on('submit(demo1)', function (data) {
            //layer.msg(JSON.stringify(data.field));
            data.field.contracts = contracts;

            var json = data.field;
            console.log(json);
           ajaxSubmit(json,Api.FWDT_Customer_Dw.Add_Motify_Customer,"POST",function (res) {
                       console.log("msg信息------" + res.msg);
                       // alert("添加成功");
                       var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
                       parent.layui.table.reload('transport_unit_library', {page: {curr: 1}});
                       parent.layer.msg('添加成功');
                       parent.layer.close(index);
           },"json");
            // $.ajax({
            //     type: "POST",
            //     url: Api.FWDT_Customer_Dw.Add_Motify_Customer,
            //     data: json,
            //     dataType: 'json',
            //     beforeSend: function (request) {
            //         request.setRequestHeader("KJCY-TOKEN", sessionStorage.getItem('token'));
            //         //request.setRequestHeader("FORM-TOKEN", fd);
            //         request.setRequestHeader("Content-Type", "application/json");
            //     },
            //     success: function (res) {
            //         console.log("msg信息------" + res.msg);
            //         // alert("添加成功");
            //         var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
            //         parent.layui.table.reload('transport_unit_library', {page: {curr: 1}});
            //         parent.layer.msg('添加成功');
            //         parent.layer.close(index);
            //
            //     },
            //     error: function (XMLHttpResponse, textStatus, errorThrown) {
            //         console.log("1 异步调用返回失败,XMLHttpResponse.readyState:" + XMLHttpResponse.readyState);
            //         console.log("2 异步调用返回失败,XMLHttpResponse.status:" + XMLHttpResponse.status);
            //         console.log("3 异步调用返回失败,textStatus:" + textStatus);
            //         console.log("4 异步调用返回失败,errorThrown:" + errorThrown);
            //
            //     }
            // })


            return false;
        });
    });
</script>
</html>